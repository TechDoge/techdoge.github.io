---
layout:     post
title:      Java IO概述
date:       2019-08-10
author:     ctrlcoder
header-img: 
catalog: true
tags:
    - Java
typora-root-url: ..
---

### IO流
谈到IO，我们会想到从磁盘读取的文件IO，网络请求的Socket IO，还有可能我们不怎么常用的跨进程通信的管道IO......
这些在Java中都被抽象为“流”，读取源就是输入流（`InputStream`），输出目标就是输出流（`OutputStream`）。

**IO流的分类：**
- 按照流的流向分，可以分为**输入流**和**输出流**；
- 按照操作单元划分，可以划分为**字节流**和**字符流**；
- 按照流的角色划分，可以划分为**节点流**和**处理流**。

**流的原理浅析:**

Java IO流共涉及40多个类，这些类看上去很杂乱，但实际上很有规则，而且彼此之间存在非常紧密的联系，Java IO流的40多个类都是从如下4个抽象类基类中派生出来的。
- `InputStream/Reader`: 所有的输入流的基类，前者是字节输入流，后者是字符输入流。
- `OutputStream/Writer`: 所有输出流的基类，前者是字节输出流，后者是字符输出流。

**在使用中：读取纯文本数据优选用字符流，其他使用字节流。**
![](/img/assets_2019/16c7446c3f05a859)

**按操作对象分类图**

![](/img/assets_2019/16c7447ccee5b85e)



### 新IO
- 首先，传统java.io包提供了诸如File的抽象，输入，输出流。交互方式是同步，阻塞；
- 第二，在java1.4中引入NIO框架（java.nio包），提供了Channel，Selector，Buffer等抽象，构建多路复用的，同步非阻塞IO，同时提供了更接近操作系统底层的高性能数据操作方式；　　
- 第三，在Java 7中，NIO有了进一步的改进，也就是NIO 2。其引入了异步非阻塞IO方式，或者说AIO（Asynchronous IO）。异步IO基于事件和回调机制。


**异步和同步**　　
- 同步，一种可靠有序的运行机制，在进行同步操作时，后续的任务要等待当前调用返回；　　
- 异步，其他任务不需要等待当前调用是否返回，依靠事件，回调机制来实现任务调用。

**阻塞和非阻塞**　　
- 阻塞，当前线程处于阻塞状态，无法从事其他任务，只有当条件就绪才能继续；　　
- 非阻塞，不管IO操作是否结束，直接返回，相应的操作在后台继续处理

**同步和异步是结果，阻塞和非阻塞是过程。**
- IO，阻塞同步通信模式，客户端与服务端三次握手，简单，吞吐量小。
- NIO，非阻塞同步通信模式，客户端与服务端通过Channel连接，采用多路复用器轮询注册的Channel。
- AIO，非阻塞异步通信模式，基于事件和回调机制，采用异步通道实现异步通信。